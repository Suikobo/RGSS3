# WAVE式バトル

## 機能説明
１つの戦闘で複数の敵グループとの戦いを演出するWAVE式バトルを追加します。  
ステータス強化や戦闘中のみ状態異常も引き継がれるため、通常の連続戦闘とはまた違う楽しみを演出できます。  
【注意】この機能はイベントコマンドからのバトルにのみ対応しています。 ランダムエンカウントでは利用できません。

## 導入方法
「▼ 素材」できるだけ他の素材より下に設置して下さい。

## 使用方法
### □ WAVE式バトルの起動
イベントコマンド「注釈」に以下のコマンドを記述して下さい。
~~~
<wave_battle n>
　引数：n => 各Waveの最初に自動起動されるコモンイベントのＩＤ
　　　※このイベントで何ＷＡＶＥ目かの演出等を作成して下さい（スクリーンショット３）
~~~

### □ ターン数の扱いについて
この素材では、設定した敵グループとの戦闘すべてを１つの戦闘として扱います。  
従って、WAVE2以降の戦闘では、前のWAVEで経過したターン数の続きから開始される事になります。（WAVE1が4ターンで終わった場合、WAVE5は5ターン目から始まる）  

この時、影響があるのが敵キャラの行動パターンでの行動条件を「ターン数」で指定する場合と、バトルイベントの起動条件で「ターン数」を指定する場合です。WAVE2の最初のターンで特殊なスキルを使わせたい場合や特別なイベントを実行したい場合があっても、その時何ターンが経過してるかはプレイヤーの行動しだいになるのです。  

では、現在のWAVEで経過したターンで処理したい場合はどうするかと言うと、以下のタグを使用します。  
このタグを、敵キャラでは「メモ」欄に（スクリーンショット４）、バトルイベントでは該当ページの「注釈」コマンドに（スクリーンショット５）記述すると、「ターン数」の処理の際に今のWAVEが始まってからの経過ターン数が使用されるようになります。
~~~
<wave_turns>
~~~

### □ 「逃走可能」「負けた場合も継続」のオプションについて
バトルの処理コマンドの機能「逃走可能」と「負けた場合も継続」のオプション設定は必ず最後のイベントコマンドに設定して下さい。  
途中のイベントコマンドに設定した場合、そのバトルの処理までが１つの戦闘として扱われ、戦闘終了後にマップに戻った後に再度次のバトルとして処理されます。 （スクリーンショット２）

### □ 「逃走可能」「負けた場合も継続」の個別設定について
WAVEごとに個別に「逃走可能」と「負けた場合も継続」の設定を変更したい場合は、<wave_battle n>で起動されるコモンイベントで以下のスクリプトを実行して下さい。  
~~~
逃走可能：BattleManager.wave_escape(flag)
　引数：flag => 「true」で逃走可能、「false」で逃走不可となります。

負け継続：BattleManager.wave_lose(flag)
　引数：flag => 「true」で継続、「false」でゲームオーバーとなります。
~~~

【注意】  
この機能で変更した設定は、次のWAVEに移行しても継続されます。  
WAVE2で変更した値をWAVE3は元に戻したい等の場合は再度WAVE3のコモンイベントで設定しなおして下さい。  
  
【注意】  
この機能で逃走可能や負けた場合も継続可能にしても、最後のバトルの処理コマンドにイベントが無かった場合は「逃げた場合」と「負けた場合」のイベント分岐は発生しません。  
解決策としては、最後のバトルの処理コマンドでは逃走可能等にしておいて、途中禁止したいWAVEで逃走不可等の変更を実施してください。


## コンフィグ設定
### □ WAVE_NOW
この設定で指定したゲーム変数には、現在何WAVE目のバトル中かの数字が保存されています。  
起動したコモンイベントで「ＷＡＶＥ１／３」等の演出のための分岐にご利用下さい。

### □ WAVE_MAX
通常の選択肢は上下キーで項目を選択しますが、ピクチャ選択肢では絵を左右に並べています。  
直感的に操作できるように左右キーを有効にする必要があります。  
左右キーを有効にするには「true」を設定して下さい。
